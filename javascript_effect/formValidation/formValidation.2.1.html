<!DOCTYPE html>
<html lang="zh">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<link rel="stylesheet" href="../../css_passage/css_reset.css">
	<link rel="stylesheet" href="css/css.css">
</head>
<body>
	<form action="xxx.php" id="formValidation">
		<div><label><span>姓名</span><input type="text" name="UserName" placeholder="中文姓名"></label></div>
		<div><label><span>短信验证码</span><input type="text" name="code" placeholder="短信验证码"></label><input type="button" value="获取验证码" id="getCode"></div>
		<div class="imgCode"><label><span>图片验证码</span><input type="text" name="imgCode" placeholder="图片验证码"></label></div>
		<div><label><span>新密码</span><input type="password" name="UserPass" placeholder="新密码"></label></div>
		<div><label><input type="checkbox" id="checkbox">同意永利宝用户协议和投资人注册协议</label></div>
		<input type="submit" value="确定" id="submit">
		<div id="pt">{$err}</div>
	</form>
	<script src="../../javascript_passage/mScore.js"></script>
	<script src="../../javascript_passage/js_passage.js"></script>
	<script src="js/formValidation.2.1.js"></script>
	<script src="../../javascript_passage/jquery-1.4.2.min.js"></script>
	<script>
		formValidation('formValidation',{
		        UserName : [/^1\d{10}|[A-Za-z][A-Za-z0-9_-]{5,24}|[\u4E00-\u9FA5\uf900-\ufa2dA-Za-z0-9_-]{1,24}$/,'请输入正确的用户名/手机号。'],
		        UserPass : [/^.{6,32}$/,'密码必须由6-32位字符组成'],
		        code : [/^\d{4}$/,'请输入正确的短信验证码'],
		        imgCode : [/^.{4}$/,'请输入正确的图片验证码']
		    },{
		        mouseBlur : function(dom,ecma){
		               // ecma.myTip();
		               ecma.publicTip();
		        },
		        imgCode : function(succFn,failFn){
		            //验证码验证
		            // 图片验证码
		            var imgActive;
		            var url = '/User/Login/checkoutpreg/?preg='+$('.imgCode').val();
		            var aaa = $.ajax({
		                type: "POST",
		                url: url,
		                success: function(data){
		                    if(data['status'] == 0){
		                        imgActive = false;
		                        if(succFn) succFn(imgActive);
		                    }else{
		                        imgActive = true;
		                        if(failFn) failFn(imgActive);
		                    }
		                }
		            });
		        },
		        getCode : function(dom){
		            // 手机获取验证码
		            var url = "/User/Register/sendCode";
		            $.ajax({
		                type: "POST",
		                url: url,
		                data: "mobile=" + document.getElementsByName('UserName')[0].value + "&vcode=" + dom.value,
		                success: function(msg){
		                    var pt = document.getElementById('pt');
		                    if(!isNaN(msg)){
		                        if(msg == -1){
		                            alert('页面已过期');
		                            window.location.href="/User/Register";
		                            return;
		                        }
		                        if(msg == 2){
		                          pt.innerHTML = '对不起，该手机已被注册';
		                          return;
		                        }
		                        if(msg == 3){
		                            pt.innerHTML = '手机验证码发送失败';
		                            return;
		                        }
		                        if(msg == 5){
		                            pt.innerHTML = '发送超限，24小时后再试';
		                            return;
		                        }
		                        if(msg == 6){
		                            pt.innerHTML = '请输入正确的短信验证码';
		                            return;
		                        }
		                        if(msg == 4){
		                            pt.innerHTML = '对不起，请间隔2分钟再发送';
		                            return;
		                        }
		                    }else{
		                        if(msg.num && msg.num!= undefined){
		                            pt.innerHTML = '该手机还可获取' + msg.num + '次验证码，请尽快完成验证';
		                        }
		                    }
		                }
		            });
		        }
		    });

			// 协议
		    // (function(){
		    //     var bl = true;
		    //     var form1 = document.getElementById('formValidation');
		    //     var b = form1.getElementsByTagName('b')[0];
		    //     b.onclick = function(){
		    //         if(bl){
		    //             b.className = 'on';
		    //             bl = false;
		    //         }else{
		    //             b.className = '';
		    //             bl = true;
		    //         }
		    //     };
		    // })()





		// xxx.onchange = function(){
		// 	if(/(\.jpg|\.jpeg|\.gif|\.png)$/i.test(this.files[0].name)){
		// 		var createImg = new Image();
		// 		createImg.src = window.URL.createObjectURL(this.files[0]);
  //               createImg.onload = function(){
  //                   window.URL.revokeObjectURL(this.src);
  //               };
  //               this.parentNode.insertBefore(createImg,this);
		// 	}else{
		// 		var createDiv = document.createElement('div');
		// 		createDiv.innerHTML = '11111111111';
		// 		createDiv.onclick = function(){alert(1111)};
		// 		var createDivText = document.createTextNode('您的文件不符合类型');
		// 		document.body.appendChild(createDiv);
		// 		this.parentNode.insertBefore(createDivText,this);
		// 	};
		// }
	</script>
</body>
</html>